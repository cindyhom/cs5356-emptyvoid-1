<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('../partials/head') %>

</head>

<script src="https://www.gstatic.com/firebasejs/9.6.9/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.9/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.9/firebase-auth-compat.js"></script>
<script>
   const firebaseApp = firebase.initializeApp({ 
      apiKey: "AIzaSyD7iI_l0XTIhgiyQzaw5PADbdWFia7B9CY",
      authDomain: "emptyvoid-47fab.firebaseapp.com",
      projectId: "emptyvoid-47fab",
      storageBucket: "emptyvoid-47fab.appspot.com",
      messagingSenderId: "493812433604",
      appId: "1:493812433604:web:fbfa8519284e8eef86bf91",
      measurementId: "G-8TKK2V9JSY"
    });
   const db = firebaseApp.firestore();
   const auth = firebaseApp.auth();
</script>

<body>
  <header>
    <%- include('../partials/nav', { email: user.email }) %>
  </header>

  <div class="container">
    <div class="columns">
      <div class="column is-3 " style="text-align: right;">
        <aside class="menu">
          <p class="menu-label">
            Personal
          </p>
          <ul class="menu-list">
            <li><a>Feed</a></li>

          </ul>
        </aside>
      </div>
      <div class="column is-4">
        <div class="mb-6">
          <div class="has-text-weight-bold mb-2">
            Create a new thought
          </div>
          <form id="post-rant" action="/dog-messages" method="post">
            <input class="input" type="text" name="message" placeholder="What's on your mind?" />
            <button class="button mt-2">Rant!</button>
          </form>
        </div>
        <div class="feed-stream">
          <%- include('../partials/feed-stream', { feed: feed }) %>
        </div>
      </div>
    </div>
  </div>

</body>

<%- include('../partials/footer') %>

<script src="https://www.gstatic.com/firebasejs/9.6.4/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.4/firebase-auth-compat.js"></script>

<script>

  window.onload = () => {
    console.log('Running onload')
    const firebaseConfig = {
      // CS5356 TODO #2
      // Copy your Firebase config here too
      apiKey: "AIzaSyD7iI_l0XTIhgiyQzaw5PADbdWFia7B9CY",
      authDomain: "emptyvoid-47fab.firebaseapp.com",
      projectId: "emptyvoid-47fab",
      storageBucket: "emptyvoid-47fab.appspot.com",
      messagingSenderId: "493812433604",
      appId: "1:493812433604:web:fbfa8519284e8eef86bf91",
      measurementId: "G-8TKK2V9JSY"
    };

    document
    .getElementById("post-rant")
    .addEventListener("submit", (event) => {

      const message = event.target.message.value
      console.log(message)
      debugger;

      db.collection("rants").add({
        username: "username",
        rant: message,
        timestamp: "time" // TODO
      })
      .then(() => {
        console.log("Document successfully written!");
      })
      .catch((error) => {
        console.error("Error writing document: ", error);
      });
    });
  };
</script>

</html>
